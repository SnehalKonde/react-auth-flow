{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;;;;;;;;;;AAAA;;;;;;;;;;;;AAEA,IAAM,oBAAoB,mBAA1B;AACA,IAAM,cAAc;AACnB,QAAO,OADY;AAEnB,SAAQ;AAFW,CAApB;;IAKM,W;;;;;;;uBAEA,M,EAAQ;AACZ,QAAK,KAAL,GAAa,OAAO,KAApB;AACA,QAAK,SAAL,GAAiB,OAAO,SAAxB;AACA,QAAK,mBAAL,GAA2B,OAAO,mBAAlC;AACA,QAAK,cAAL,GAAsB,OAAO,cAA7B;;AAEA,UAAO,EAAE,iBAAiB,KAAK,qBAAxB,EAAP;AACA;;;+BAEY;AACZ,UAAO,aAAa,OAAb,CAAqB,iBAArB,CAAP;AACA;;;2BAEQ,I,EAAM;AACd,UAAO,QAAQ,KAAK,mBAApB;AACA,QAAK,KAAL,CAAW,QAAX,CAAoB,KAAK,cAAL,CAAoB,IAApB,CAApB;AACA;;;0CAEuC;AAAA,OAAlB,KAAkB,yDAAZ,EAAY;AAAA,OAAR,MAAQ;;AACvC,OAAG,EAAE,UAAU,MAAZ,CAAH,EAAwB;AACvB,WAAO,IAAP;AACA;;AAED,OAAI,YAAY,OAAO,MAAP,CAAc,EAAd,EAAkB,KAAlB,CAAhB;AACA,WAAO,OAAO,IAAd;AACC,SAAK,YAAY,KAAjB;AACC,eAAU,OAAV,IAAqB,OAAO,OAAP,CAAe,KAApC;AACA,eAAU,SAAV,IAAuB,OAAO,OAAP,CAAe,OAAtC;AACA;AACD,SAAK,YAAY,MAAjB;AACC,eAAU,OAAV,IAAqB,IAArB;AACA,eAAU,SAAV,IAAuB,IAAvB;AACA;AACD;AACC,YAAO,KAAP;AAVF;;AAaA,UAAO,SAAP;AACA;;;wBAEK,K,EAAO,O,EAAS;AACrB,QAAK,KAAL,CAAW,QAAX,CAAoB;AACnB,UAAM,YAAY,KADC;AAEnB,aAAS;AACR,YAAO,KADC;AAER,cAAS;AAFD;AAFU,IAApB;AAOA,gBAAa,OAAb,CAAqB,iBAArB,EAAwC,KAAxC;AACA;;;oCAEiB;AACjB,OAAI,QAAQ,aAAa,OAAb,CAAqB,iBAArB,CAAZ;AACA,OAAI,CAAC,KAAD,IAAU,UAAU,IAAxB,EAA8B;AAC7B,WAAO,KAAP;AACA,IAFD,MAEO;AACN,WAAO,IAAP;AACA;AACD;;;2BAEQ;AACR,QAAK,KAAL,CAAW,QAAX,CAAoB;AACnB,UAAM,YAAY;AADC,IAApB;AAGA,gBAAa,UAAb,CAAwB,iBAAxB;AACA,QAAK,QAAL,CAAc,KAAK,SAAnB;AACA;;;8BAEW,gB,EAAkB;AAC7B,OAAI,iBAAiB,KAAK,cAA1B;AACA,OAAI,YAAY,IAAhB;AACA,OAAI,QAAQ,KAAK,KAAjB;AACA,OAAI,YAAY,KAAK,SAArB;;AAEA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,0CACsB;AACpB,WAAK,SAAL;AACA;AAHF;AAAA;AAAA,+CAK2B,QAL3B,EAKqC;AACnC,WAAK,SAAL;AACA;AAPF;AAAA;AAAA,iCASa;AACX,UAAG,CAAC,UAAU,eAAV,EAAJ,EAAiC;AAChC,WAAI,qBAAqB,KAAK,KAAL,CAAW,QAAX,CAAoB,QAA7C;AACA,WAAI,iBAAJ;AACA,WAAI,kBAAJ;AACA,aAAM,QAAN,CAAe,eAAe,YAAY,QAAZ,GAAuB,kBAAtC,CAAf;AACA;AACD;AAhBF;AAAA;AAAA,8BAkBU;AACR,UAAI,gBAAgB,UAAU,eAAV,MAA+B,0BAAc,gBAAd,eAAoC,KAAK,KAAzC,EAAnD;AACA,aAAO,aAAP;AACA;AArBF;;AAAA;AAAA,KAA4C,gBAAM,SAAlD;AAuBA;;;;;;AAGK,IAAM,oCAAc,IAAI,WAAJ,EAApB","file":"app.js","sourcesContent":["import React, { createElement } from 'react';\n\nconst localStorageConst = 'rightStayHostAuth';\nconst actionConst = {\n\tLOGIN: 'LOGIN',\n\tLOGOUT: 'LOGOUT'\n}\n\nclass AuthService {\n\n\tinit(params) {\n\t\tthis.store = params.store;\n\t\tthis.loginPath = params.loginPath;\n\t\tthis.defaultRedirectPath = params.defaultRedirectPath;\n\t\tthis.redirectAction = params.redirectAction;\n\n\t\treturn { 'authorization': this.authenticationReducer };\n\t}\n\n\tgetContext() {\n\t\treturn localStorage.getItem(localStorageConst);\n\t}\n\n\tredirect(path) {\n\t\tpath = path || this.defaultRedirectPath;\n\t\tthis.store.dispatch(this.redirectAction(path));\n\t}\n\n\tauthenticationReducer(state={}, action) {\n\t\tif(!('type' in action)) {\n\t\t\treturn sate;\n\t\t}\n\n\t\tlet nextState = Object.assign({}, state);\n\t\tswitch(action.type) {\n\t\t\tcase actionConst.LOGIN:\n\t\t\t\tnextState['token'] = action.payload.token;\n\t\t\t\tnextState['context'] = action.payload.context;\n\t\t\t\tbreak;\n\t\t\tcase actionConst.LOGOUT:\n\t\t\t\tnextState['token'] = null;\n\t\t\t\tnextState['context'] = null;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn state;\n\t\t}\n\n\t\treturn nextState\n\t}\n\n\tlogin(token, context) {\n\t\tthis.store.dispatch({\n\t\t\ttype: actionConst.LOGIN,\n\t\t\tpayload: {\n\t\t\t\ttoken: token,\n\t\t\t\tcontext: context\n\t\t\t}\n\t\t});\n\t\tlocalStorage.setItem(localStorageConst, token);\n\t}\n\n\tisAuthenticated() {\n\t\tlet token = localStorage.getItem(localStorageConst);\n\t\tif( !token || token === null ){\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tlogout() {\n\t\tthis.store.dispatch({\n\t\t\ttype: actionConst.LOGOUT\n\t\t});\n\t\tlocalStorage.removeItem(localStorageConst);\n\t\tthis.redirect(this.loginPath);\n\t}\n\n\trequireAuth(wrappedComponent) {\n\t\tlet redirectAction = this.redirectAction;\n\t\tlet _instance = this;\n\t\tlet store = this.store;\n\t\tlet loginPath = this.loginPath;\n\n\t\treturn class AuthenticatedComponent extends React.Component {\n\t\t\tcomponentWillMount() {\n\t\t\t\tthis.checkAuth();\n\t\t\t}\n\n\t\t\tcomponentWillReceiveProps(nextProp) {\n\t\t\t\tthis.checkAuth();\n\t\t\t}\n\n\t\t\tcheckAuth() {\n\t\t\t\tif(!_instance.isAuthenticated()) {\n\t\t\t\t\tlet redirectAfterLogin = this.props.location.pathname;\n\t\t\t\t\tlog('inside instance');\n\t\t\t\t\tlog(redirectAfterLogin);\n\t\t\t\t\tstore.dispatch(redirectAction(loginPath + '?next=' + redirectAfterLogin));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trender() {\n\t\t\t\tlet renderElement = _instance.isAuthenticated() && createElement(wrappedComponent, {...this.props});\n\t\t\t\treturn renderElement;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport const authService = new AuthService();"]}